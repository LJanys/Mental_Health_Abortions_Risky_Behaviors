Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=2
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=2
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=2
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=0.1
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=0.1
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=0.1
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
beta1=0.1
beta2=0.1
A<-rnorm(1000)
B=rnorm(1000,0,10)
Z1<-beta1*A+beta2*B
Z2<-beta1*A-beta2*B
cor(Z1,Z2)
library(data.table)
install.packages("data.table")
library(simGWAS)
install.packages("simGWAS")
library(simGWAS)
set.seed(42)
set.seed(42)
nsnps <- 100
nhaps <- 1000
lag <- 5 # genotypes are correlated between neighbouring variants
maf <- runif(nsnps+lag,0.05,0.5) # common SNPs
laghaps <- do.call("cbind", lapply(maf, function(f) rbinom(nhaps,1,f)))
View(laghaps)
############---------------------------Main analysis file------------------------------------############################
###########---------------------------for the simulations--------------------------------------------------------######
rm(list=ls())
setwd('~/Dropbox/spillovers health/Abortions/Codes/Data_Simulation')
library("plm")
library("dplyr")
library("ggplot2")
library(data.table)
library(tictoc)
library(tidyr)
library(Rfast)
library(pracma)
#library(dplyr)
library(patchwork)
library(here)
library(readr)
library(dotwhisker)
library(broom)
#ggsave(path = "figs", filename = "fig1.png")
####Summarizing the changes in the coefficients####
###First for N=1000###############################
n=1000
#theta<-as.data.frame(read.table("1000theta_1_rep"))
OLS<-colMeans(read.table(paste0(n,"ols")))
FE<-colMeans(read.table(paste0(n,"fe")))
theta_1<-as.data.frame(read.table(paste0(n,"theta_1_rep")))
help<-theta_1%>%
group_by(V1) %>%
summarize(mean_size = mean(V2, na.rm = TRUE))
pdf(paste0(n,"sim_coef.pdf"))
ggplot(help,aes(V1,mean_size),colour)+
geom_point()
dev.off()
mn = c(OLS[2],FE[2],help$mean_size[2:5])
#######We can make the analogous plot with Bettinas code#####################
se<-as.data.frame(read.table(paste0(n,"se_rep")))
help<-se%>%
group_by(V1) %>%
summarize(mean_size = mean(V2, na.rm = TRUE))
pdf(paste0(n,"sim_se.pdf"))
ggplot(help,aes(V1,mean_size),colour)+
geom_point()
dev.off()
se = c(OLS[3],FE[3],help$mean_size[2:5])
name = c("OLS", "OLS FE", "GFE G2", "GFE G3", "GFE G4", "GFE G5")
# mn = c(0.0308,0.0092,0.0009, 0.0008, 0.0003)
# typeof(mn)
# se = c(0.0053,0.0036,0.0014, 0.0010,0.0008 )
# typeof(se)
name = c("OLS", "OLS FE", "GFE G2", "GFE G3", "GFE G4","GFE G5")
ci95_low = mn - 1.96*se
ci95_up = mn + 1.96*se
dat2 <-data.frame(name, mn,se,ci95_low, ci95_up)
dat <- data.frame(name,mn,se)
str(dat)
pdf(file=paste0(n,"_coeff_plot_sim.pdf"))
ggplot(dat, aes(name, mn)) +
theme_bw()+
geom_hline(yintercept=0, lty=2, lwd=1, colour="black")+
geom_errorbar(aes(ymin=mn - 1.96*se, ymax=mn + 1.96*se), lwd=1, colour="red", width=0)+
geom_point(size=4, pch=21, fill="black") +
labs(x="model coefficients", y="magnitude") +
scale_x_discrete(limits = c("OLS", "OLS FE", "GFE G2", "GFE G3", "GFE G4","GFE G5"))
dev.off()
BIC<-as.data.frame(read.table(paste0(n,"BIC")))
help<-BIC%>%
group_by(V1) %>%
summarize(mean_size = mean(V2, na.rm = TRUE))
help<-data.frame(cbind(help,as.factor(c(0,0,1,0,0))))
help
highlight.gene <- "G1"
set.seed(23456)
a <- data.frame(GeneName = paste("G", 1:10, sep = ""),
Index1 = runif(10, 100, 200),
Index2 = runif(10, 100, 150))
a$highlight <- ifelse(a$GeneName == highlight.gene, "highlight", "normal")
textdf <- a[a$GeneName == highlight.gene, ]
mycolours <- c("highlight" = "red", "normal" = "grey50")
a
textdf
ggplot(data = a, aes(x = Index1, y = Index2)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = "my label")) +
theme(legend.position = "none") +
theme()
highlight.gene <- "G1"
set.seed(23456)
a <- data.frame(GeneName = paste("G", 1:10, sep = ""),
Index1 = runif(10, 100, 200),
Index2 = runif(10, 100, 150))
a$highlight <- ifelse(a$GeneName == highlight.gene, "highlight", "normal")
textdf <- a[a$GeneName == highlight.gene, ]
mycolours <- c("highlight" = "red", "normal" = "grey50")
a
textdf
ggplot(data = a, aes(x = Index1, y = Index2)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = expression(G[0]))) +
theme(legend.position = "none") +
theme()
highlight.gene <- "G1"
set.seed(23456)
a <- data.frame(GeneName = paste("G", 1:10, sep = ""),
Index1 = runif(10, 100, 200),
Index2 = runif(10, 100, 150))
a$highlight <- ifelse(a$GeneName == highlight.gene, "highlight", "normal")
textdf <- a[a$GeneName == highlight.gene, ]
mycolours <- c("highlight" = "red", "normal" = "grey50")
a
textdf
ggplot(data = a, aes(x = Index1, y = Index2)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = "G")) +
theme(legend.position = "none") +
theme()
View(a)
textdf
highlight.gene <- "G1"
set.seed(23456)
a <- data.frame(GeneName = paste("G", 1:10, sep = ""),
Index1 = runif(10, 100, 200),
Index2 = runif(10, 100, 150))
View(a)
help$highlight <- c("normal","normal""highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
help$highlight <- c("normal","normal","highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
View(help)
BIC<-as.data.frame(read.table(paste0(n,"BIC")))
help<-BIC%>%
group_by(V1) %>%
summarize(mean_size = mean(V2, na.rm = TRUE))
help$highlight <- c("normal","normal","highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
mycolours <- c("highlight" = "red", "normal" = "grey50")
textdf
ggplot(data = a, aes(x = Index1, y = Index2)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
#geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = "G")) +
theme(legend.position = "none") +
theme()
highlight.gene <- "G1"
set.seed(23456)
a <- data.frame(GeneName = paste("G", 1:10, sep = ""),
Index1 = runif(10, 100, 200),
Index2 = runif(10, 100, 150))
a$highlight <- ifelse(a$GeneName == highlight.gene, "highlight", "normal")
textdf <- a[a$GeneName == highlight.gene, ]
mycolours <- c("highlight" = "red", "normal" = "grey50")
ggplot(data = a, aes(x = Index1, y = Index2)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
#geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = "G")) +
theme(legend.position = "none") +
theme()
ggplot(data = a, aes(x = Index1, y = Index2)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = Index1 * 2.05, y = Index2, label = "G")) +
theme(legend.position = "none") +
theme()
View(a)
View(help)
View(a)
textdf <- help[help$V1==3,]
textdf
ggplot(data = help, aes(x = V1, y = mean_size)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = Index1 * 1.05, y = Index2, label = "G")) +
theme(legend.position = "none") +
theme()
ggplot(data = help, aes(x = V1, y = mean_size)) +
geom_point(size = 3, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = V1 * 1.05, y = mean_size, label = "G")) +
theme(legend.position = "none") +
theme()
ggplot(data = help, aes(x = V1, y = mean_size)) +
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = V1 * 1.1, y = mean_size, label = "True G")) +
theme(legend.position = "none") +
theme()+
labs(x="Number of Groups", y="BIC")
ggplot(data = help, aes(x = V1, y = mean_size)) +
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = V1 * 1.5, y = mean_size, label = "True G")) +
theme(legend.position = "none") +
theme()+
labs(x="Number of Groups", y="BIC")
ggplot(data = help, aes(x = V1, y = mean_size)) +
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = V1 * 1.2, y = mean_size, label = "True G")) +
theme(legend.position = "none") +
theme()+
labs(x="Number of Groups", y="BIC")
library("plm")
library("dplyr")
library("ggplot2")
library(data.table)
library(tictoc)
library(tidyr)
library(Rfast)
library(pracma)
#library(dplyr)
library(patchwork)
library(here)
library(readr)
library(dotwhisker)
library(broom)
library(here)
here()
here("Codes", "Data_Simulation", "awesome.txt")
#here("Codes", "Data_Simulation", "awesome.txt")
setwd(here("Codes"))
getwd()
setwd(here("Codes","Data_Simulation"))
getwd()
#theta<-as.data.frame(read.table("1000theta_1_rep"))
OLS<-colMeans(read.table(paste0(n,"ols")))
####Summarizing the changes in the coefficients####
###First for N=1000###############################
n=1000
#theta<-as.data.frame(read.table("1000theta_1_rep"))
OLS<-colMeans(read.table(paste0(n,"ols")))
############---------------------------Main analysis file------------------------------------############################
###########---------------------------for the simulations--------------------------------------------------------######
library("plm")
library("dplyr")
library("ggplot2")
library(data.table)
library(tictoc)
library(tidyr)
library(Rfast)
library(pracma)
#library(dplyr)
library(patchwork)
library(here)
library(readr)
library(dotwhisker)
library(broom)
here()
set_here()
#setwd(here("Codes","Data_Simulation"))
getwd()
############---------------------------Main analysis file------------------------------------############################
###########---------------------------for the simulations--------------------------------------------------------######
library("plm")
library("dplyr")
library("ggplot2")
library(data.table)
library(tictoc)
library(tidyr)
library(Rfast)
library(pracma)
#library(dplyr)
library(patchwork)
library(here)
library(readr)
library(dotwhisker)
library(broom)
here()
set_here()
theme_bw()+
)
############---------------------------Main analysis file------------------------------------############################
###########---------------------------for the simulations--------------------------------------------------------######
library("plm")
library("dplyr")
library("ggplot2")
library(data.table)
library(tictoc)
library(tidyr)
library(Rfast)
library(pracma)
#library(dplyr)
library(patchwork)
library(here)
library(readr)
library(dotwhisker)
library(broom)
highlight.gene <- 3
help$highlight <- c("normal","normal","highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
mycolours <- c("highlight" = "red", "normal" = "black")
textdf <- help[help$V1==3,]
BIC=c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312)
BIC1=c(0.0576050828922096, 0.0593159328139334,0.0602834259474787,0.0606411349631031)
highlight.gene <- 2
help$highlight <- c("normal","highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
help=c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312)
help$highlight <- c("normal","highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
help=data.frame(c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312),c("normal","highlight","normal","normal"))
help
mycolours <- c("highlight" = "red", "normal" = "black")
names(help)=c("data","highlight")
help=data.frame(c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312),c("normal","highlight","normal","normal"))
names(help)=c("V1","highlight")
help=data.frame(c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312),c("normal","highlight","normal","normal"),c(2,3,4,5))
names(help)=c("V1","highlight","G")
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = mean_size, label = "True G")) +
theme(legend.position = "none") +
theme()+
ylim(2,14)+
labs(x="Number of Groups", y="BIC") )
textdf <- help[help$G==2,]
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = mean_size, label = "True G")) +
theme(legend.position = "none") +
theme()+
ylim(2,14)+
labs(x="Number of Groups", y="BIC") )
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "True G")) +
theme(legend.position = "none") +
theme()+
ylim(2,14)+
labs(x="Number of Groups", y="BIC") )
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "True G")) +
theme(legend.position = "none") +
theme()+
ylim(0,1)+
labs(x="Number of Groups", y="BIC") )
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "True G")) +
theme(legend.position = "none") +
theme()+
ylim(0,2)+
labs(x="Number of Groups", y="BIC") )
BIC=c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312)
help=data.frame(c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312),c("highlight","normal","normal","normal"),c(2,3,4,5))
names(help)=c("V1","highlight","G")
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "")) +
theme(legend.position = "none") +
theme()+
ylim(0,2)+
labs(x="Number of Groups", y="BIC") )
pdf(file=here("Abortion_Draft","BIC1.pdf"))
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "")) +
theme(legend.position = "none") +
theme()+
ylim(0,2)+
labs(x="Number of Groups", y="BIC") )
dev.off()
help=data.frame(BIC,c("highlight","normal","normal","normal"),c(2,3,4,5))
names(help)=c("V1","highlight","G")
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "")) +
theme(legend.position = "none") +
theme()+
ylim(0,2)+
labs(x="Number of Groups", y="BIC") )
BIC=c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312)
BIC1=c(0.0576050828922096, 0.0593159328139334,0.0602834259474787,0.0606411349631031)
help=data.frame(BIC1,c("highlight","normal","normal","normal"),c(2,3,4,5))
names(help)=c("V1","highlight","G")
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "")) +
theme(legend.position = "none") +
theme()+
ylim(0,2)+
labs(x="Number of Groups", y="BIC") )
pdf(file=here("Abortion_Draft","BIC1.pdf"))
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "")) +
theme(legend.position = "none") +
theme()+
ylim(0,1)+
labs(x="Number of Groups", y="BIC") )
dev.off()
BIC=c(0.0962518361340252, 0.13660757707267,0.176216236773346,0.215211387906312)
BIC1=c(0.0576050828922096, 0.0593159328139334,0.0602834259474787,0.0606411349631031)
help=data.frame(BIC,c("highlight","normal","normal","normal"),c(2,3,4,5))
names(help)=c("V1","highlight","G")
highlight.gene <- 2
#help$highlight <- c("normal","highlight","normal","normal")#ifelse(a$GeneName == highlight.gene, "highlight", "normal")
mycolours <- c("highlight" = "red", "normal" = "black")
textdf <- help[help$G==2,]
pdf(file=here("Abortion_Draft","BIC.pdf"))
print(ggplot(data = help, aes(x = G, y = V1)) +
theme_bw()+
geom_point(size = 4, aes(colour = highlight)) +
scale_color_manual("Status", values = mycolours) +
geom_text(data = textdf, aes(x = G * 1.1, y = V1, label = "")) +
theme(legend.position = "none") +
theme()+
ylim(0,1)+
labs(x="Number of Groups", y="BIC") )
dev.off()
here
library(here)
getwd()
############---------------------------Main analysis file------------------------------------############################
###########---------------------------for the simulations--------------------------------------------------------######
library("plm")
library("dplyr")
library("ggplot2")
library(data.table)
library(tictoc)
library(tidyr)
library(Rfast)
library(pracma)
#library(dplyr)
library(patchwork)
library(here)
library(readr)
library(dotwhisker)
library(broom)
getwd()
set_here()
